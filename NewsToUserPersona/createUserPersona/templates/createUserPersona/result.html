<!doctype html>
<html lang="en">

<head>
  <title>User Persona Generated</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS v5.2.0-beta1 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
    integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

</head>

<body>
  <main>
    <div class="container-fluid sticky-top bg-white shadow">
      <header class="d-flex flex-wrap flex-row justify-content-center py-3 border-bottom">
        <a href="/createUserPersona"
          class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
          <svg class="bi me-2" width="40" height="32">
            <use xlink:href="#bootstrap" />
          </svg>
          <span class="fs-4">News To User Persona</span>
        </a>

        <!-- <ul class="nav nav-pills">
          <li class="nav-item"><a href="#" class="nav-link active" aria-current="page">Home</a></li>
          <li class="nav-item"><a href="#" class="nav-link">Features</a></li>
          <li class="nav-item"><a href="#" class="nav-link">Pricing</a></li>
          <li class="nav-item"><a href="#" class="nav-link">FAQs</a></li>
          <li class="nav-item"><a href="#" class="nav-link">About</a></li>
        </ul> -->
      </header>
    </div>


    <div class="container-fluid bg-secondary">
      <div class="row justify-content-center mb-5 pb-5">

        <!-- semua item yang dideteksi -->
        <div class="col-3">
          <div class="container bg-light shadow-sm mt-3 px-4 py-1 rounded-3">
            {% if individual_item %}

            <div class="my-3">
              <h4 class="py-1 border-bottom">Names
                <span class="badge bg-primary">{{individual_item.jumlah_nama}}</span>
              </h4>
              {% for each in individual_item.names %}
              <div class="d-flex flex-row">
                <div class="p-1 col-1 me-1 text-end text-secondary">{{ forloop.counter }}</div>
                <div class="flex-fill mb-1 ps-2 p-1 draggable border bg-white" draggable="true">{{ each }}</div>
              </div>
              <!-- <div class="mb-1 ps-2 p-1 draggable border bg-white" draggable="true">{{ each }}</div> -->
              {% endfor %}
            </div>

            <div class="my-3">
              <h4 class="py-1 border-bottom">Job Titles
                <span class="badge bg-primary">{{ individual_item.jumlah_job }}</span>
              </h4>
              {% for each in individual_item.jobs %}
              {% if each and each != 'N/A' and each != '[]' %}
              <div class="d-flex flex-row">
                <div class="p-1 col-1 me-1 text-end text-secondary">{{ forloop.counter }}</div>
                <div class="flex-fill mb-1 ps-2 p-1 draggable border bg-white" draggable="true">{{ each }}</div>
              </div>
              <!-- <div class="mb-1 ps-2 p-1 draggable border  draggable bg-white" draggable="true">{{ each }}</div> -->
              {% endif %}
              {% endfor %}
            </div>


            <div class="my-3">
              <h4 class="py-1 border-bottom">Organizations
                <span class="badge bg-primary">{{ individual_item.jumlah_work }}</span>
              </h4>
              {% for each in individual_item.works %}
              {% if each and each != 'N/A' and each != '[]' %}
              <div class="d-flex flex-row">
                <div class="p-1 col-1 me-1 text-end text-secondary">{{ forloop.counter }}</div>
                <div class="flex-fill mb-1 ps-2 p-1 draggable border bg-white" draggable="true">{{ each }}</div>
              </div>
              <!-- <div class="mb-1 ps-2 p-1 draggable border  draggable bg-white" draggable="true">{{ each }}</div> -->
              {% endif %}
              {% endfor %}
            </div>

            <div class="my-3">
              <h4 class="py-1 border-bottom">Goals
                <span class="badge bg-primary">{{ individual_item.jumlah_goals }}</span>
              </h4>
              {% for each in individual_item.goals %}
              {% if each and each != 'N/A' and each != '[]' %}
              <div class="d-flex flex-row">
                <div class="p-1 col-1 me-1 text-end text-secondary">{{ forloop.counter }}</div>
                <div class="flex-fill mb-1 ps-2 p-1 draggable border bg-white" draggable="true">{{ each }}</div>
              </div>
              <!-- <div class="mb-1 ps-2 p-1 draggable border  draggable bg-white" draggable="true">{{ each }}</div> -->
              {% endif %}
              {% endfor %}
            </div>


            {% endif %}
          </div>
        </div>
        <!-- semua item yang dideteksi -->

        <!-- item yang dideteksi dan relasinya -->
        <div class="col-3">
          {% if user_persona %}
          {% for each in user_persona %}
          <div class="container_untuk_drag shadow-sm bg-white my-3 pb-3 rounded-3"
            id="container_user_persona_{{ each.name }}">

            <div class="p-1 rounded-top" id="penanda_warna"> </div>
            <div class="d-flex flex-row border-bottom p-2 mb-2">
              <!-- <div class="badge me-2 rounded-circle" id="penanda_warna"></div> -->
              <div class="fw-bold fs-5 draggable" draggable="true">{{ each.name }}</div>
              <button type="button" class="btn-close-white ms-auto align-self-center btn-sm" aria-label="Close"
                onclick="document.getElementById('container_user_persona_{{ each.name }}').remove()"></button>
            </div>

            <div class="d-flex flex-row mb-1 px-2">
              <div class="p-1 text-secondary">Job Title</div>
              {% if each.job_title %}
              <div class="p-1 border flex-fill draggable" draggable="true">{{ each.job_title }}</div>
              {% else %}
              <div class="p-1 border flex-fill draggable bg-light" draggable="true"></div>
              {% endif %}
            </div>


            <div class="d-flex flex-row mb-1 px-2">
              <div class="p-1 text-secondary">Organization/Work</div>
              {% if each.work %}
              <div class="p-1 border flex-fill draggable" draggable="true">{{ each.work }}</div>
              {% else %}
              <div class="p-1 border flex-fill draggable bg-light" draggable="true"></div>
              {% endif %}
            </div>

            {% for goal in each.goals %}
            <div class="d-flex flex-row mb-1 mx-2 ps-2 draggable border" draggable="true">
              <div class="p-1 flex-fill">{{ goal }}</div>
              <div class="p-1" id="penanda_warna"></div>
            </div>
            {% endfor %}

          </div>
          {% endfor %}
          {% else %}
          <p>No polls are available.</p>
          {% endif %}
        </div>

        <!-- untuk editingnya -->
        <div class="col-4">
          <div class="col-4 shadow-sm bg-white my-3 pb-3 position-fixed">

            <div class="d-flex flex-row border-bottom mb-2 ">
              <div class="p-3 me-2" id="penanda_warna"></div>
              <div class="col container_untuk_drag">
                <div class="fw-bold fs-5 text-secondary" id="delete_after_drop">User Persona Name</div>
              </div>
            </div>

            <div class="d-flex flex-row mb-1 px-2">
              <div class="p-1 text-secondary">Job Title</div>
              <div class="p-1 border flex-fill container_untuk_drag"></div>
            </div>

            <div class="d-flex flex-row mb-1 px-2">
              <div class="p-1 text-secondary">Organization/Work</div>
              <div class="p-1 border flex-fill container_untuk_drag"></div>
            </div>


            <div class="d-flex flex-row mb-1 border-top">
              <div class="col container_untuk_drag h-50 pb-5">
                <div class="text-center text-secondary pt-3" id="delete_after_drop">drag goals item here</div>
              </div>
            </div>

          </div>
        </div>
        <!-- untuk editingnya -->


      </div>

      <!-- untuk menampilkan teks beritanya -->
      <div class="row justify-content-center mt-3 bg-light py-3 fixed-bottom shadow-lg">

        <button class=" col-3 btn btn-sm btn-outline-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvas"
          aria-controls="offcanvasBottom">Konten berita</button>

        <div class="offcanvas offcanvas-bottom h-75" tabindex="-1" id="offcanvas"
          aria-labelledby="offcanvasBottomLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasBottomLabel">Konten Berita</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
          </div>

          <div class="offcanvas-body bg-light offcanvas-lg lh-lg">
            {{ konten }}
          </div>


        </div>



      </div>




    </div>

  </main>
  <footer>
    <!-- place footer here -->
  </footer>


  <!-- Bootstrap JavaScript Libraries -->
  <script>
    const draggables = document.querySelectorAll('.draggable')
    const containers = document.querySelectorAll('.container_untuk_drag')


    draggables.forEach(draggable => {
      draggable.addEventListener('dragstart', () => {
        console.log('drag mulai')
        draggable.classList.add('dragging')
      })

      draggable.addEventListener('dragend', () => {
        console.log('drag selesai')
        draggable.classList.remove('dragging')
      })

      draggable.addEventListener('dblclick', () => {
        draggable.remove()
      })


    })

    containers.forEach(container => {
      container.addEventListener('dragover', e => {
        e.preventDefault()

        console.log('lagi ada yang didrag')

        const draggable = document.querySelector('.dragging')
        const draggable_clone = draggable.cloneNode(true)

        if (container.querySelector('#delete_after_drop')) {
          container.querySelector('#delete_after_drop').classList.add('visually-hidden')
        }

        container.appendChild(draggable)
      })

    })

    containers.forEach(container => {
      const warna = randomHexColor();
      console.log(container)
      const item_goal = container.querySelectorAll('#penanda_warna')
      for (i = 0; i < item_goal.length; i++) {
        item_goal[i].style.backgroundColor = warna;
      }
    })




    function randomHexColor() {
      let hexCode = '#' + Math.random().toString(16).substring(2, 8);

      return hexCode
    }


  </script>

  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js"
    integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous">
    </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"
    integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK" crossorigin="anonymous">
    </script>
</body>

</html>